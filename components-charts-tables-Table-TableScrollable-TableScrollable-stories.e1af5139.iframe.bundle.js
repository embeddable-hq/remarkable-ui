"use strict";(self.webpackChunk_embeddable_com_remarkable_ui=self.webpackChunk_embeddable_com_remarkable_ui||[]).push([[812],{"./src/components/charts/tables/Table/TableScrollable/TableScrollable.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,Resize:()=>Resize,__namedExportsOrder:()=>__namedExportsOrder,default:()=>TableScrollable_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),tables_module=__webpack_require__("./src/components/charts/tables/tables.module.css"),TableHeader=__webpack_require__("./src/components/charts/tables/Table/components/TableHeader/TableHeader.tsx"),TableBody=__webpack_require__("./src/components/charts/tables/Table/components/TableBody/TableBody.tsx"),react=__webpack_require__("./node_modules/react/index.js");const TableScrollable=(0,react.forwardRef)(({sort,onSortChange,showIndex,headers,rows,onNextPage,hasMoreData=!0,className,onRowIndexClick,isLoading=!1,loadingLabel="Loading...",bottomDistanceToPrefetch},ref)=>{const scrollRef=(0,react.useRef)(null),sentinelRef=(0,react.useRef)(null);return(0,react.useImperativeHandle)(ref,()=>({scrollToTop:(behavior="auto")=>{scrollRef.current?.scrollTo({top:0,behavior})},getScrollElement:()=>scrollRef.current}),[]),function useInfiniteScroll({rootRef,enabled=!0,onPrefetch,bottomDistanceToPrefetch=750}){const loadingRef=(0,react.useRef)(!1);(0,react.useEffect)(()=>{if(!enabled)return;const el=rootRef.current;if(!el)return;const onScroll=()=>{if(!enabled)return;if(loadingRef.current)return;const{scrollTop,clientHeight,scrollHeight}=el;scrollHeight-(scrollTop+clientHeight)<=bottomDistanceToPrefetch&&(loadingRef.current=!0,onPrefetch())};return onScroll(),el.addEventListener("scroll",onScroll,{passive:!0}),()=>el.removeEventListener("scroll",onScroll)},[enabled,onPrefetch,rootRef,bottomDistanceToPrefetch]),(0,react.useEffect)(()=>{enabled&&(loadingRef.current=!1)},[enabled])}({rootRef:scrollRef,enabled:hasMoreData&&!isLoading,onPrefetch:onNextPage,bottomDistanceToPrefetch}),(0,jsx_runtime.jsx)("div",{className:(0,clsx.A)(tables_module.A.tableFullContainer,className),children:(0,jsx_runtime.jsxs)("div",{ref:scrollRef,className:(0,clsx.A)(tables_module.A.tableAdjustedContainer,tables_module.A.fullWidth),children:[(0,jsx_runtime.jsxs)("table",{className:(0,clsx.A)(tables_module.A.table,tables_module.A.cellWrap),"aria-label":"Scrollable table",children:[(0,jsx_runtime.jsx)(TableHeader.A,{showIndex,headers,sort,onSortChange}),(0,jsx_runtime.jsx)(TableBody.B,{showIndex,headers,rows,onRowIndexClick,bottomRef:sentinelRef,isLoading,hasMoreData})]}),isLoading&&(0,jsx_runtime.jsx)("div",{className:tables_module.A.loadingIndicator,children:loadingLabel})]})})});TableScrollable.displayName="TableScrollable",TableScrollable.__docgenInfo={description:"",methods:[{name:"scrollToTop",docblock:null,modifiers:[],params:[{name:"behavior",optional:!0,type:null}],returns:null},{name:"getScrollElement",docblock:null,modifiers:[],params:[],returns:null}],displayName:"TableScrollable",props:{bottomDistanceToPrefetch:{required:!1,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""},hasMoreData:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},headers:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  id: keyof T;\n  title: React.ReactNode;\n  align?: TableHeaderItemAlign;\n  field?: keyof T;\n  minWidth?: CssSize;\n  sort?: TableSort<T>;\n  accessor?: (row: T) => React.ReactNode;\n  cell?: TableHeaderCell;\n}",signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"title",value:{name:"ReactReactNode",raw:"React.ReactNode",required:!0}},{key:"align",value:{name:"unknown[union]",raw:"(typeof TableHeaderAlign)[keyof typeof TableHeaderAlign]",required:!1}},{key:"field",value:{name:"T",required:!1}},{key:"minWidth",value:{name:"union",raw:"number | `${number}px` | `${number}rem` | `${number}em` | `${number}%`",elements:[{name:"number"},{name:"literal",value:"`${number}px`"},{name:"literal",value:"`${number}rem`"},{name:"literal",value:"`${number}em`"},{name:"literal",value:"`${number}%`"}],required:!1}},{key:"sort",value:{name:"signature",type:"object",raw:"{\n  id: keyof T;\n  direction: (typeof TableSortDirection)[keyof typeof TableSortDirection];\n}",signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"direction",value:{name:"unknown[union]",raw:"(typeof TableSortDirection)[keyof typeof TableSortDirection]",required:!0}}]},required:!1}},{key:"accessor",value:{name:"signature",type:"function",raw:"(row: T) => React.ReactNode",signature:{arguments:[{type:{name:"T"},name:"row"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}},required:!1}},{key:"cell",value:{name:"signature",type:"function",raw:"(props: {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any;\n  className?: string;\n}) => React.ReactElement<HTMLTableCellElement>",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any;\n  className?: string;\n}",signature:{properties:[{key:"value",value:{name:"any",required:!0}},{key:"className",value:{name:"string",required:!1}}]}},name:"props"}],return:{name:"ReactReactElement",raw:"React.ReactElement<HTMLTableCellElement>",elements:[{name:"HTMLTableCellElement"}]}},required:!1}}]}}],raw:"TableHeaderItem<T>[]"},description:""},isLoading:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},loadingLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Loading...'",computed:!1}},rows:{required:!0,tsType:{name:"Array",elements:[{name:"T"}],raw:"T[]"},description:""},showIndex:{required:!1,tsType:{name:"boolean"},description:""},sort:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  id: keyof T;\n  direction: (typeof TableSortDirection)[keyof typeof TableSortDirection];\n}",signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"direction",value:{name:"unknown[union]",raw:"(typeof TableSortDirection)[keyof typeof TableSortDirection]",required:!0}}]}},description:""},onNextPage:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRowIndexClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(rowIndex: number) => void",signature:{arguments:[{type:{name:"number"},name:"rowIndex"}],return:{name:"void"}}},description:""},onSortChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: TableSort<T> | undefined) => void",signature:{arguments:[{type:{name:"union",raw:"TableSort<T> | undefined",elements:[{name:"signature",type:"object",raw:"{\n  id: keyof T;\n  direction: (typeof TableSortDirection)[keyof typeof TableSortDirection];\n}",signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"direction",value:{name:"unknown[union]",raw:"(typeof TableSortDirection)[keyof typeof TableSortDirection]",required:!0}}]}},{name:"undefined"}]},name:"value"}],return:{name:"void"}}},description:""}}};var external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/preview-api"),storybook_constants=__webpack_require__("./src/storybook.constants.tsx"),tables_test=__webpack_require__("./src/components/charts/tables/Table/tables.test.tsx");const TableScrollable_stories={title:"Charts/TableScrollable",component:TableScrollable,args:{showIndex:!0,pageSize:3,page:0,headers:tables_test.P,total:100},argTypes:{onSortChange:{action:"onSortChange"},rowHeight:{control:{type:"number"}},headerHeight:{control:{type:"number"}},footerHeight:{control:{type:"number"}}}},allClients=(0,tables_test._)(1e3),pages=Array.from({length:Math.ceil(allClients.length/10)},(_,i)=>allClients.slice(10*i,10*(i+1))),renderScrollable=args=>{const[,updateArgs]=(0,external_STORYBOOK_MODULE_PREVIEW_API_.useArgs)();return(0,jsx_runtime.jsx)(TableScrollable,{...args,onNextPage:async()=>{if(args.isLoading)return;updateArgs({isLoading:!0});const delay=300+Math.floor(900*Math.random());await new Promise(r=>setTimeout(r,delay));const nextPage=args.page??0,nextRows=pages[nextPage]??[],rows=(args.rows??(0,tables_test._)(1e3).slice(0,10)).concat(nextRows),hasMoreData=nextPage+1<pages.length;updateArgs({rows,page:nextPage+1,isLoading:!1,hasMoreData})},headers:args.headers,rows:args.rows??(0,tables_test._)(1e3).slice(0,10),onSortChange:newSort=>{updateArgs({sort:newSort}),args.onSortChange?.(newSort)},hasMoreData:args.hasMoreData??!0,isLoading:args.isLoading??!1})},Basic={render:renderScrollable},Resize={render:renderScrollable,decorators:storybook_constants.TL},__namedExportsOrder=["Basic","Resize"]}}]);