"use strict";(self.webpackChunk_embeddable_com_remarkable_ui=self.webpackChunk_embeddable_com_remarkable_ui||[]).push([[355],{"./src/components/charts/pies/DonutChart/DonutChart.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,Resize:()=>Resize,WithTotal:()=>WithTotal,WithTotalAndLabel:()=>WithTotalAndLabel,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DonutChart_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-chartjs-2/dist/index.js"),chart=__webpack_require__("./node_modules/chart.js/dist/chart.js"),chartjs_plugin_datalabels_esm=__webpack_require__("./node_modules/chartjs-plugin-datalabels/dist/chartjs-plugin-datalabels.esm.js"),chartjs_plugin_annotation_esm=__webpack_require__("./node_modules/chartjs-plugin-annotation/dist/chartjs-plugin-annotation.esm.js"),pies_utils=__webpack_require__("./src/components/charts/pies/pies.utils.ts"),chartjs_utils=__webpack_require__("./src/components/charts/chartjs.utils.ts"),mergician_esm=__webpack_require__("./node_modules/mergician/dist/mergician.esm.js"),charts_module=__webpack_require__("./src/components/charts/charts.module.css");chart.t1.register(chart.Bs,chart.m_,chart.s$,chartjs_plugin_datalabels_esm.A,chartjs_plugin_annotation_esm.A);const DonutChart=({label,subLabel,options={},data,onSegmentClick,showLegend=!0,showTooltips=!0,showValueLabels=!0})=>{const containerRef=(0,react.useRef)(null),chartRef=(0,react.useRef)(null),donutLabelOptions=(0,mergician_esm.i)((0,pies_utils.Nj)({showLegend,showTooltips,showValueLabels,label,subLabel}),options),{height,width}=((elRef,timeout=100)=>{const[size,setSize]=(0,react.useState)({width:0,height:0}),timeoutRef=(0,react.useRef)(void 0);return(0,react.useLayoutEffect)(()=>{const el=elRef.current;if(!el)return;const updateSize=rect=>{setSize({width:Math.max(0,rect.width),height:Math.max(0,rect.height)})},ro=new ResizeObserver(entries=>{const entry=entries[0];entry&&(timeoutRef.current&&clearTimeout(timeoutRef.current),timeoutRef.current=window.setTimeout(()=>{updateSize(entry.contentRect)},timeout))});return ro.observe(el),updateSize(el.getBoundingClientRect()),()=>{timeoutRef.current&&clearTimeout(timeoutRef.current),ro.disconnect()}},[elRef,timeout]),size})(containerRef,0),hideChart=height<10||width<10;return(0,jsx_runtime.jsx)("div",{className:charts_module.A.chartContainer,ref:containerRef,children:hideChart?null:(0,jsx_runtime.jsx)(dist.Fq,{ref:chartRef,data:(0,pies_utils.Jo)(data),options:donutLabelOptions,onClick:event=>{const indexClicked=(0,chartjs_utils.x)(event,chartRef);onSegmentClick?.(indexClicked)}})})};DonutChart.__docgenInfo={description:"",methods:[],displayName:"DonutChart",props:{data:{required:!0,tsType:{name:"ChartData",elements:[{name:"literal",value:"'pie'"}],raw:"ChartData<'pie'>"},description:""},options:{required:!1,tsType:{name:"Partial",elements:[{name:"ChartOptions",elements:[{name:"literal",value:"'pie'"}],raw:"ChartOptions<'pie'>"}],raw:"Partial<ChartOptions<'pie'>>"},description:"",defaultValue:{value:"{}",computed:!1}},onSegmentClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number | undefined) => void",signature:{arguments:[{type:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},name:"index"}],return:{name:"void"}}},description:""},showLegend:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showTooltips:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showValueLabels:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},label:{required:!1,tsType:{name:"string"},description:""},subLabel:{required:!1,tsType:{name:"string"},description:""}}};var pies_mock=__webpack_require__("./src/components/charts/pies/pies.mock.ts"),storybook_constants=__webpack_require__("./src/storybook.constants.tsx");const DonutChart_stories={title:"Charts/DonutChart",component:DonutChart,args:{data:pies_mock.X}},Default={decorators:storybook_constants.uk},WithTotal={args:{label:"Total"},decorators:storybook_constants.uk},WithTotalAndLabel={args:{label:"Total",subLabel:(pies_mock.X.datasets[0]?.data??[]).reduce((a,b)=>a+b,0).toString()},decorators:storybook_constants.uk},Resize={decorators:storybook_constants.TL},__namedExportsOrder=["Default","WithTotal","WithTotalAndLabel","Resize"]},"./src/components/charts/pies/pies.mock.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{X:()=>pieDataMock});const pieDataMock={labels:["Orange 1","Orange 2","Orange 3","Orange 4","Orange 5","Orange 6"],datasets:[{data:[12,19,3,5,2,3]}]}},"./src/components/charts/pies/pies.utils.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{BY:()=>getPieChartOptions,Jo:()=>getPieChartData,Nj:()=>getDonutChartOptions});var mergician__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/mergician/dist/mergician.esm.js"),_charts_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/charts/charts.constants.ts"),_chartjs_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/charts/chartjs.constants.ts"),_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/styles/styles.utils.ts");const getPieChartData=data=>{const chartColors=(0,_charts_constants__WEBPACK_IMPORTED_MODULE_1__.p)();return{...data,datasets:data.datasets?.map(dataset=>{const colors=dataset.data.map((_value,index)=>chartColors[index%chartColors.length]),defaultDataset={backgroundColor:colors,borderColor:colors};return(0,mergician__WEBPACK_IMPORTED_MODULE_0__.i)(defaultDataset,dataset)})||[]}},getPieChartOptions=options=>{const pieChartOptions={plugins:{legend:{display:options.showLegend},datalabels:{display:!!options.showValueLabels&&"auto"},tooltip:{enabled:options.showTooltips}}};return(0,mergician__WEBPACK_IMPORTED_MODULE_0__.i)((0,_chartjs_constants__WEBPACK_IMPORTED_MODULE_2__.a8)(),pieChartOptions)},getDonutChartOptions=options=>{const donutChartOptions={cutout:"60%",elements:{arc:{borderWidth:1}},plugins:{annotation:{annotations:{innerlabel:{content:[options.label,options.subLabel].filter(Boolean),type:"doughnutLabel",font:[{size:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-number-line-height","2.375rem"),weight:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-number-font-weight","700"),height:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-number-line-height","2.375rem"),family:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.g)("--em-piechart-font-family","sans-serif")},{size:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-label-font-size","1rem"),weight:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-label-font-weight","500"),height:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.F)("--em-piechart-donut-label-line-height","1rem"),family:(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.g)("--em-piechart-font-family","sans-serif")}],color:[(0,_styles_styles_utils__WEBPACK_IMPORTED_MODULE_3__.g)("--em-piechart-donut-color","#212129")]}}}}};return(0,mergician__WEBPACK_IMPORTED_MODULE_0__.i)(getPieChartOptions(options),donutChartOptions)}}}]);